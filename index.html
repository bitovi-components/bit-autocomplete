<!-- Template to load -->
<script type="text/stache" id="demo" can-autorender>
  <can-import from="bit-autocomplete"/>
  <bit-autocomplete model="{Search}" selected-item="{selectedItem}" validated="{validated}"></bit-autocomplete>
  <p>{{#validated}}You selected {{selectedItem.label}}.{{else}}Do a search then select an item...{{/validated}}</p>
</script>

<!-- Loading Script -->
<script src="./node_modules/steal/steal.js" main="can/view/autorender/">
	import $ from "jquery";
	import can from "can";
	import "can/view/stache/";
    import "can/util/fixture/";
    import "can/map/define/";
    //import "can/view/stache/system";
        
    var fruits = [
        { label: "Granny Smith Apple"},
        { label: "McIntosh Apple"},
        { label: "Fuji Apple"},
		{ label: "Red Delicious Apple"},
		{ label: "Pink Lady Apple"},
		{ label: "Golden Delcicious Apple"},
		{ label: "Gala Apple"},
		{ label: "Strawberry"},
		{ label: "Orange"},
		{ label: "Plum"},
		{ label: "Blueberry"},
		{ label: "Pear"},
		{ label: "Peach"},
		{ label: "Tomato"},
		{ label: "Fig"},
		{ label: "Watermelon"},
		{ label: "Melon"},
		{ label: "Sprite Melon"},
		{ label: "Lemon"}
    ];

    can.fixture('GET /test', function(req) {
        var filtered = fruits.filter(function(item) {
            return item.label.toLowerCase().indexOf(req.data.label.toLowerCase()) > -1;
        });
        return filtered;
    });
    
    var Search = can.Model.extend({
        findAll: "GET /test"
    },{});
    
    var ViewModel = can.Map.extend({
        define: {
            selectedItem: {
                value: {}
            },
            validated: {
                value: false,
                type: 'boolean'
            }
        },
        Search: Search
    });
    console.log("assigning scope");
    $('#demo').data("scope",  new ViewModel({}) );
    
    //$('body').append(can.view('demo')( new ViewModel({}) ) );
</script>
